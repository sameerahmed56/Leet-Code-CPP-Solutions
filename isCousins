class Solution {
public:
    int findDepth(TreeNode* root, int z,int depth){
        if(root==nullptr)
            return -1;
        if(root-> val == z){
            return depth;
        }
        return max(findDepth(root->left, z, depth+1),findDepth(root->right, z, depth+1));
    }
    bool hasSameParent(TreeNode* root, int mainDepth,int x, int y, int depth){
        if(root == nullptr || depth >= mainDepth){
            return false;
        }
        if(mainDepth==depth+1){
            if(root->left!=nullptr){
                if(root->left->val==x){
                    if(root->right!=nullptr && root->right->val==y){
                        return true;
                    }
                }
            }
            if(root->right!=nullptr){
                if(root->right->val==x){
                    if(root->left!=nullptr && root->left->val==y){
                        return true;
                    }
                }
            }
        }
        return hasSameParent(root->left,mainDepth,x,y,depth+1) || hasSameParent(root->right,mainDepth,x,y,depth+1);
    }
    bool isCousins(TreeNode* root, int x, int y) {
        if(root==nullptr)
            return false;
        int xDepth = findDepth(root, x, 0);
        int yDepth = findDepth(root, y, 0);
        if(xDepth == yDepth){
            return !hasSameParent(root,xDepth,x,y,0);
        }
        return false;
    }
};
